# 1.虚拟地址和物理地址

---

## 1.1 概念

**物理地址：**
- 指真实存在于内存条上的地址。
- 是硬件层面访问内存的地址。
- 直接由内存控制器使用，用来访问物理内存上的数据。

**虚拟地址：**
- 是程序运行时看到和使用的地址。
- 每个进程有独立的虚拟地址空间，互不干扰。
- 通过 **页表（Page Table）和MMU（内存管理单元）** 映射到物理地址。

映射过程通常 **由硬件（MMU）自动完成** ，操作系统负责维护页表。

---

## 1.2 地址大小决定因素

1. **虚拟地址大小决定因素：**
- **处理器的位数（架构）**：
  - 32位系统：最大虚拟地址空间是 \(2^{32}\) = 4GB
  - 64位系统：理论上是 \(2^{64}\)，但实际操作系统可能限制为更小（如 Linux 下常见的是 48 位虚拟地址）

- **操作系统设计**：
  - OS可能将虚拟地址空间划分为用户空间和内核空间，例如 Linux 在 32 位下用户空间是 3GB，内核空间是 1GB。

2. **物理地址大小决定因素：**
- **CPU支持的物理地址位数（PAE等技术）**：
  - 虽然 CPU 是 32 位，也可以通过 PAE 技术支持大于 4GB 的物理内存。
  - 64 位 CPU 通常支持 36~52 位物理地址（即支持几十 GB 到数 TB 的内存）

- **主板支持的最大内存**：
  - 芯片组和主板也限制了实际可用的物理内存容量。

可以看出虚拟地址有多大，跟 **内存大小** 、 **磁盘容量** 这些是没有关系的。

---

**对比表**

| 类型     | 虚拟地址                     | 物理地址                             |
| -------- | ---------------------------- | ------------------------------------ |
| 定义     | 进程看到和使用的地址         | 实际内存中的地址                     |
| 控制者   | 操作系统 + MMU               | 内存控制器                           |
| 大小限制 | 由CPU位数 + 操作系统限制决定 | 由CPU地址总线 + 主板支持内存大小决定 |
| 是否隔离 | 每个进程独立                 | 所有进程共享（通过映射访问）         |

---

# 2.工作集和工作集窗口

- **工作集：** 是一个进程在某段时间内需要的 **页面集合** ，通常包括该进程最近一段时间内访问过的页面。随着时间的推移，工作集会动态变化，随着进程的执行，活跃的页面集合会变化。
- **工作集窗口：** 是一个 **时间窗口** 或 **时间段** ，用来定义在特定时间内，进程所使用的内存页面集合。工作集窗口决定了在计算工作集时考虑的时间范围。

>> 比如工作集窗口大小为`6`，在`t`时刻的最近`6`个访问页面是`6, 0, 3, 2, 3, 2`，那么形成的工作集就是`{6, 0, 3, 2}`。

---

